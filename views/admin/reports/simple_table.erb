<table>
  <thead>
  <tr>
    <% data.fields.each do |column| %>

        <% column = users[:label] if (defined? users) && (column == users[:column]) %>

        <td style="font-size: 16px; font-weight: bold; border: 1px solid black"><%= column %></td>

    <% end %>

  </tr>
  </thead>
  <tbody>
  <% data.each do |row| %>
      <tr>
        <% row.each do |column, value| %>

            <% value = users[:data].get_user_label(value) if (defined? users) && (column == users[:column]) %>

            <td style="border: 1px solid black"><%= value %></td>
        <% end %>
      </tr>
  <% end %>
  </tbody>

</table>