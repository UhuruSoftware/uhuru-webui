<div class="modal-background"> </div>
<form action="/updateApp" method="post">
    <div class="modal app_details" id="details_<%= app.name %>">

      <div class="modal_header">
        <%= app.name %>
      </div>

      <div class="modal_content">
        <div>
          <span class="app_status">Status: "<%= app.state %>"</span>
          <div class="app_status_buttons">
            <button type="button" class="image s24px trash" title="Delete '<%= app.name %>'"></button>

            <% if app.state != "STOPPED" %>
                <% hide = 'hide' %>
            <% end %>

            <label for="state">Start app? </label><input type="checkbox" name="state" value="<%= 'start' %>" checked/>
          </div>
        </div>

        <div>
          <div>
                <span>Instances&nbsp;&nbsp;</span><input type="text" class="pass_app_instances instances_count" value="<%= app.instances %>" />
                <button type="button" class="image s24px minus subtract_instance"></button>
                <button type="button" class="image s24px plus add_instance"></button>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <span>Memory&nbsp;&nbsp;</span><input type="text" name="appMemory" id="app_memory_setup" value="<%= app.memory %>"/> MB
                <button type="button" class="image s24px minus subtract_memory"></button>
                <button type="button" class="image s24px plus add_memory"></button>
          </div>
        </div>

        <hr />

        <div>
          <table>
            <tr>
              <td>Name</td>
              <td>Type</td>
              <td>Plan</td>
              <td></td>
            </tr>

            <% app.services.each do |service| %>
                <tr>
                  <td class="name"><%= service.name %></td>
                  <td><%= service.type %></td>
                  <td><%= service.plan %></td>
                  <td class="action">
                    <button type="button" class="image s24px trash unbind_service_button" title="Delete '<%= service.name %>'" id="<%= service.name %>"></button>
                  </td>
                </tr>
            <% end %>

            <tr>
              <td>
                <select class="small_input selected_service">
                    <% services_list.each do |service| %>
                        <option value="<%= service.name %>" id="<%= app.name %>"> <%= service.name %> </option>
                    <% end %>
                </select>
              </td>
              <td id="refresh_service_type">
                  <label><%= defined?(services_list[0].type) ? services_list[0].type : '-' %></label>
              </td>
              <td id="refresh_service_plan">
                  <label><%= defined?(services_list[0].plan) ? services_list[0].plan : '-' %></label>
              </td>
              <td class="action">
                <button type="button" class="image s24px plus" title="Bind Service"></button>
              </td>
            </tr>
          </table>

          <table>
            <tr>
              <td>Host Name</td>
              <td>Domain</td>
              <td></td>
            </tr>

            <% app.uris.each do |uri| %>
                <tr>
                  <td class="name"><%= app.name %></td>
                  <td class="url"><%= uri.url %></td>
                  <td class="action">
                    <button type="button" class="image s24px trash unbind_uri_button" title="Unbind '<%= uri.url %>'" id="<%= uri.url %>"></button>
                  </td>
                </tr>
            <% end %>

            <tr>
              <td><input value="<%= app.name %>" type="text" class="small_input" /></td>
              <td>
                <select class="small_input">
                  <% domains_list.each do |domain| %>
                      <% if domain.owning_org_name == organization_name || domain.owning_org_name == 'Shared' %>
                          <option value="<%= domain.guid %>"><%= domain.name %></option>
                      <% end %>
                  <% end %>
                </select>
              </td>
              <td class="action">
                <button type="button" class="image s24px plus" title="Add URL"></button>
              </td>
            </tr>
          </table>
        </div>
      </div>

      <% unless error_message.nil? || error_message.empty? %>
          <div class="error"> <%= error_message %> </div>
      <% end %>



      <div class="modal_footer">
        <input name="name"                 value="<%= app.name %>"              type="hidden" class="send_app_name"/>
        <input name="instances"            value="<%= app.instances %>"         type="hidden" class="send_app_instances"/>
        <input name="memory"               value="<%= app.memory %>"            type="hidden" class="send_app_memory"/>
        <input name="current_organization" value="<%= current_organization %>"  type="hidden" id="current_organization"/>
        <input name="current_space"        value="<%= current_space %>"         type="hidden" id="current_space"/>
        <input name="current_tab"          value="<%= current_tab %>"           type="hidden" id="current_tab" />





          <div>
            <button type="button" onclick="window.location.assign('<%= Uhuru::Webui::SinatraRoutes::ORGANIZATIONS + "/#{current_organization}/spaces/#{current_space}/apps" %>');">Cancel</button>
            <button type="submit" class="update_button">Update</button>
          </div>
      </div>
    </div>
</form>